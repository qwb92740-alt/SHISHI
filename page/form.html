<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>用户评价 - 旅游管理系统</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="../css/public.css" media="all">
    <style>
        /* 评价列表样式 */
        .comment-item {
            border-bottom: 1px solid #f2f2f2;
            padding: 15px 0;
            display: flex;
            align-items: flex-start;
        }
        .comment-info {
            flex: 1;
        }
        .comment-nickname {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .comment-time {
            font-size: 12px;
            color: #999;
        }
        .comment-rating {
            color: #FF5722;
            font-size: 16px;
            margin: 5px 0;
        }
        .comment-content {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .comment-images {
            display: flex;
            flex-wrap: wrap;
        }
        .comment-image {
            width: 80px;
            height: 80px;
            margin-right: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        /* 回复按钮样式 */
        .reply-btn {
            margin-left: 10px;
            color: #009688;
            cursor: pointer;
        }
        /* 图片预览弹窗样式 */
        .preview-mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .preview-image {
            max-width: 90%;
            max-height: 90%;
            border-radius: 4px;
        }
    </style>
</head>
<body>
<div class="layuimini-container">
    <div class="layuimini-main">

        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>用户评价列表</legend>
        </fieldset>

        <!-- 评价列表 -->
        <div id="commentList" class="layui-card">
            <div class="layui-card-body">
                <!-- 评价项将通过JS动态加载 -->
            </div>
        </div>

        <!-- 分页 -->
        <div id="commentPagination" class="layui-text-center" style="margin-top: 20px;"></div>

        <!-- 图片预览弹窗 -->
        <div id="imagePreview" class="preview-mask" onclick="hidePreview()">
            <img id="previewImage" class="preview-image" src="">
        </div>
    </div>
</div>

<script src="../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
<script>
    layui.use(['form', 'laypage', 'layer'], function () {
        var $ = layui.jquery,
            form = layui.form,
            laypage = layui.laypage,
            layer = layui.layer;

        // 模拟评价数据，为每个用户设置指定图片（使用更稳定的国内图片链接）
        var commentData = [
            {
                id: 1,
                nickname: "旅行达人小明",
                time: "2025-09-15",
                rating: 5,
                content: "云南大理太漂亮啦，蓝天碧海，非常适合度假！",
                images: [
                    "https://ts1.tc.mm.bing.net/th/id/R-C.01bb586716b5fa75d2c6968a31a6bf10?rik=1tPxTTwQLDfXTg&riu=http%3a%2f%2fy1.ifengimg.com%2f1b28778edc63062f%2f2012%2f0613%2frdn_4fd80424b87cb.jpg&ehk=7lglXO4IEOREoc4bVmJb0bZSD6h4s00ddO3rSEKBHBE%3d&risl=&pid=ImgRaw&r=0"
                ]
            },
            {
                id: 2,
                nickname: "小李同学",
                time: "2025-09-14",
                rating: 4,
                content: "长城太雄伟了，沿着山脊蜿蜒，仿佛一条巨龙，让人感受到历史的厚重！",
                images: [
                    "https://img95.699pic.com/photo/50089/4224.jpg_wh860.jpg"
                ]
            },
            {
                id: 3,
                nickname: "王女士",
                time: "2025-09-13",
                rating: 3,
                content: "泰山很有气势，登山过程虽然累，但登顶看到日出的那一刻，一切都值了！",
                images: [
                    "https://ts3.tc.mm.bing.net/th/id/OIP-C.xu3LGfp4NVP99S-bQD1NKAHaE5?rs=1&pid=ImgDetMain&o=7&rm=3"
                ]
            },
            {
                id: 4,
                nickname: "张先生",
                time: "2025-09-12",
                rating: 2,
                content: "兵马俑太震撼了，几千个形态各异的陶俑，仿佛能看到古代军队的模样！",
                images: [
                    "https://p0.ifengimg.com/pmop/2018/0327/84640B54D39B6C4A86E6C6C7E951943756EE3C60_size278_w851_h851.jpeg"
                ]
            },
            {
                id: 5,
                nickname: "赵小姐",
                time: "2025-09-11",
                rating: 5,
                content: "超棒的一次旅行，非常满意，下次还会选择这家旅行社！",
                images: [
                    "https://tse2-mm.cn.bing.net/th/id/OIP-C.BRdeXnW_XJuqAYwHU-NaowHaE6?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3"
                ]
            }
        ];

        // 渲染评价列表
        function renderCommentList(data, page) {
            var pageSize = 2;
            var start = (page - 1) * pageSize;
            var end = start + pageSize;
            var pageData = data.slice(start, end);

            var html = '';
            pageData.forEach(function (comment) {
                html += '<div class="comment-item layui-row">';
                html += '<div class="layui-col-md11 comment-info">';
                html += '<div class="comment-nickname">' + comment.nickname + '</div>';
                html += '<div class="comment-time">' + comment.time + '</div>';
                html += '<div class="comment-rating">';
                for (var i = 0; i < comment.rating; i++) {
                    html += '★';
                }
                html += '</div>';
                html += '<div class="comment-content">' + comment.content + '</div>';
                if (comment.images.length > 0) {
                    html += '<div class="comment-images">';
                    comment.images.forEach(function (image) {
                        html += '<img class="comment-image" src="' + image + '" onclick="showPreview(\'' + image + '\')" alt="评价图片">';
                    });
                    html += '</div>';
                }
                html += '</div>';
                // 添加回复按钮
                html += '<div class="layui-col-md1 reply-btn" data-comment-id="' + comment.id + '">回复</div>';
                html += '</div>';
            });

            $('#commentList .layui-card-body').html(html);

            // 绑定回复按钮点击事件
            $('.reply-btn').on('click', function () {
                var commentId = $(this).data('comment-id');
                layer.msg('点击了回复按钮，评论ID：' + commentId + '（仅演示，无实际回复功能）');
            });
        }

        // 渲染分页
        function renderPagination(data) {
            var pageSize = 2;
            var totalPages = Math.ceil(data.length / pageSize);

            laypage.render({
                elem: 'commentPagination',
                count: data.length,
                limit: pageSize,
                curr: 1,
                layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
                jump: function (obj, first) {
                    if (!first) {
                        renderCommentList(data, obj.curr);
                    }
                }
            });
        }

        // 显示图片预览
        window.showPreview = function (imageUrl) {
            $('#previewImage').attr('src', imageUrl);
            $('#imagePreview').css('display', 'flex');
        };

        // 隐藏图片预览
        window.hidePreview = function () {
            $('#imagePreview').css('display', 'none');
        };

        // 初始化
        renderCommentList(commentData, 1);
        renderPagination(commentData);
        form.render();
    });
</script>

</body>
</html>