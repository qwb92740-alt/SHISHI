<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>旅游线路管理</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/layui-src@2.6.3/dist/css/layui.css" media="all">
    <style>
        .layui-btn:not(.layui-btn-lg ):not(.layui-btn-sm):not(.layui-btn-xs) {
            height: 34px;
            line-height: 34px;
            padding: 0 15px;
        }
        .layui-form-label {
            width: 110px;
        }
        .layui-input-block {
            margin-left: 140px;
        }
        .layui-table-tool {
            padding-bottom: 10px;
        }
        .route-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        .status-active {
            background-color: #52c41a;
            color: white;
        }
        .status-inactive {
            background-color: #f5222d;
            color: white;
        }
    </style>
</head>
<body>
<div class="layuimini-container">
    <div class="layuimini-main">
        <blockquote class="layui-elem-quote">
            旅游线路管理
            <span class="layui-badge layui-bg-blue" style="margin-left: 10px;">共 <span id="total-count">8</span> 条线路</span>
        </blockquote>
        
        <div class="layui-card">
            <div class="layui-card-body">
                <div class="layui-table-tool">
                    <div class="layui-table-tool-temp">
                        <button class="layui-btn layui-btn-normal" id="addRoute">
                            <i class="layui-icon layui-icon-add-1"></i> 新增线路
                        </button>
                        <button class="layui-btn layui-btn-primary" id="refreshTable">
                            <i class="layui-icon layui-icon-refresh"></i> 刷新
                        </button>
                    </div>
                </div>
                
                <table class="layui-table" lay-size="sm" lay-filter="routeTable">
                    <thead>
                        <tr>
                            <th style="width: 40px;">ID</th>
                            <th>线路名称</th>
                            <th>出发城市</th>
                            <th>目的地</th>
                            <th>价格(元)</th>
                            <th>天数</th>
                            <th>状态</th>
                            <th style="width: 160px;">操作</th>
                        </tr>
                    </thead>
                    <tbody id="routeTableBody">
                        <!-- 表格数据将通过JS动态生成 -->
                    </tbody>
                </table>
                
                <div class="layui-table-page">
                    <div id="pagination" style="text-align: right;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 修改线路弹窗 -->
<div id="editRouteModal" style="display: none; padding: 20px;">
    <form class="layui-form" lay-filter="editRouteForm">
        <input type="hidden" name="id">
        
        <div class="layui-form-item">
            <label class="layui-form-label">线路名称</label>
            <div class="layui-input-block">
                <input type="text" name="name" lay-verify="required" placeholder="请输入线路名称" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">出发城市</label>
            <div class="layui-input-block">
                <input type="text" name="departure" lay-verify="required" placeholder="请输入出发城市" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">目的地</label>
            <div class="layui-input-block">
                <input type="text" name="destination" lay-verify="required" placeholder="请输入目的地" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">价格(元)</label>
            <div class="layui-input-block">
                <input type="number" name="price" lay-verify="required|number" min="0" placeholder="请输入价格" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">天数</label>
            <div class="layui-input-block">
                <input type="number" name="days" lay-verify="required|number" min="1" placeholder="请输入天数" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">状态</label>
            <div class="layui-input-block">
                <select name="status" lay-verify="required">
                    <option value="active">启用</option>
                    <option value="inactive">禁用</option>
                </select>
            </div>
        </div>
        
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="saveEdit">保存修改</button>
                <button type="button" class="layui-btn layui-btn-primary" id="cancelEdit">取消</button>
            </div>
        </div>
    </form>
</div>

<!-- 新增线路弹窗 -->
<div id="addRouteModal" style="display: none; padding: 20px;">
    <form class="layui-form" lay-filter="addRouteForm">
        <div class="layui-form-item">
            <label class="layui-form-label">线路名称</label>
            <div class="layui-input-block">
                <input type="text" name="name" lay-verify="required" placeholder="请输入线路名称" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">出发城市</label>
            <div class="layui-input-block">
                <input type="text" name="departure" lay-verify="required" placeholder="请输入出发城市" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">目的地</label>
            <div class="layui-input-block">
                <input type="text" name="destination" lay-verify="required" placeholder="请输入目的地" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">价格(元)</label>
            <div class="layui-input-block">
                <input type="number" name="price" lay-verify="required|number" min="0" placeholder="请输入价格" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">天数</label>
            <div class="layui-input-block">
                <input type="number" name="days" lay-verify="required|number" min="1" placeholder="请输入天数" class="layui-input">
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label">状态</label>
            <div class="layui-input-block">
                <select name="status" lay-verify="required">
                    <option value="active">启用</option>
                    <option value="inactive">禁用</option>
                </select>
            </div>
        </div>
        
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="saveAdd">添加线路</button>
                <button type="button" class="layui-btn layui-btn-primary" id="cancelAdd">取消</button>
            </div>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/layui-src@2.6.3/dist/layui.js" charset="utf-8"></script>
<script>
    layui.use(['form', 'layer', 'laypage'], function() {
        var form = layui.form;
        var layer = layui.layer;
        var laypage = layui.laypage;
        var $ = layui.jquery;
        
        // 模拟线路数据（固定不变）
        const routeData = [
            {id: 1, name: "云南昆明大理丽江6日游", departure: "北京", destination: "云南", price: 3280, days: 6, status: "active"},
            {id: 2, name: "海南三亚5日度假游", departure: "上海", destination: "三亚", price: 4590, days: 5, status: "active"},
            {id: 3, name: "四川九寨沟黄龙4日游", departure: "成都", destination: "九寨沟", price: 2860, days: 4, status: "active"},
            {id: 4, name: "泰国曼谷芭提雅6日游", departure: "广州", destination: "泰国", price: 5690, days: 6, status: "inactive"},
            {id: 5, name: "张家界凤凰古城5日游", departure: "武汉", destination: "张家界", price: 3180, days: 5, status: "active"},
            {id: 6, name: "日本东京大阪7日游", departure: "北京", destination: "日本", price: 6890, days: 7, status: "active"},
            {id: 7, name: "新疆乌鲁木齐喀纳斯8日游", departure: "西安", destination: "新疆", price: 7680, days: 8, status: "inactive"},
            {id: 8, name: "福建厦门鼓浪屿4日游", departure: "深圳", destination: "厦门", price: 2580, days: 4, status: "active"}
        ];
        
        // 当前页码和每页条数
        let currentPage = 1;
        let pageSize = 10;
        let modalIndex = null;
        let filteredData = [...routeData]; // 用于表格渲染

        // 渲染表格数据
        function renderTable(data) {
            const tableBody = $('#routeTableBody');
            tableBody.empty();
            
            // 如果没有数据
            if (data.length === 0) {
                tableBody.append(`
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 30px;">
                            <i class="layui-icon layui-icon-info-circle" style="font-size: 20px; color: #1E9FFF;"></i>
                            <span style="margin-left: 5px;">没有找到相关线路数据</span>
                        </td>
                    </tr>
                `);
                return;
            }
            
            // 分页处理
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, data.length);
            const pageData = data.slice(startIndex, endIndex);
            
            // 渲染行数据
            pageData.forEach(route => {
                const statusClass = route.status === 'active' ? 'status-active' : 'status-inactive';
                const statusText = route.status === 'active' ? '启用' : '禁用';
                
                tableBody.append(`
                    <tr>
                        <td>${route.id}</td>
                        <td>${route.name}</td>
                        <td>${route.departure}</td>
                        <td>${route.destination}</td>
                        <td>${route.price.toFixed(2)}</td>
                        <td>${route.days}天</td>
                        <td><span class="route-status ${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="layui-btn layui-btn-xs layui-btn-normal edit-btn" data-id="${route.id}" data-name="${route.name}">
                                <i class="layui-icon layui-icon-edit"></i> 编辑
                            </button>
                            <button class="layui-btn layui-btn-xs layui-btn-danger delete-btn" data-id="${route.id}" data-name="${route.name}">
                                <i class="layui-icon layui-icon-delete"></i> 删除
                            </button>
                        </td>
                    </tr>
                `);
            });
            
            // 绑定编辑和删除事件
            bindTableEvents();
        }
        
        // 绑定表格操作事件
        function bindTableEvents() {
            // 编辑按钮事件
            $('.edit-btn').click(function() {
                const id = parseInt($(this).data('id'));
                const name = $(this).data('name');
                const route = routeData.find(r => r.id === id);
                
                if (route) {
                    // 填充表单数据
                    form.val('editRouteForm', {
                        'id': route.id,
                        'name': route.name,
                        'departure': route.departure,
                        'destination': route.destination,
                        'price': route.price,
                        'days': route.days,
                        'status': route.status
                    });
                    
                    // 打开编辑弹窗
                    modalIndex = layer.open({
                        type: 1,
                        title: '编辑线路',
                        content: $('#editRouteModal'),
                        area: ['500px', '450px'],
                        shade: 0.3
                    });
                }
            });
            
            // 删除按钮事件
            $('.delete-btn').click(function() {
                const id = parseInt($(this).data('id'));
                const name = $(this).data('name');
                
                layer.confirm(`确定要删除线路【${name}】吗？`, {
                    title: '删除确认',
                    icon: 3,
                    btn: ['确认删除', '取消']
                }, function(index) {
                    // 只显示删除提示，不实际删除数据
                    layer.close(index);
                    layer.msg(`线路【${name}】已删除`, {icon: 1});
                });
            });
        }
        
        // 渲染分页
        function renderPagination() {
            laypage.render({
                elem: 'pagination',
                count: filteredData.length,
                limit: pageSize,
                curr: currentPage,
                layout: ['prev', 'page', 'next', 'count'],
                jump: function(obj, first) {
                    if (!first) {
                        currentPage = obj.curr;
                        pageSize = obj.limit;
                        renderTable(filteredData);
                    }
                }
            });
        }
        
        // 初始化表格和分页
        renderTable(filteredData);
        renderPagination();
        
        // 刷新按钮事件
        $('#refreshTable').click(function() {
            currentPage = 1;
            filteredData = [...routeData];
            renderTable(filteredData);
            renderPagination();
            layer.msg('已刷新', {icon: 1, time: 1000});
        });
        
        // 新增线路按钮事件
        $('#addRoute').click(function() {
            // 重置表单
            form.val('addRouteForm', {
                'name': '',
                'departure': '',
                'destination': '',
                'price': '',
                'days': '',
                'status': 'active'
            });
            
            // 打开新增弹窗
            modalIndex = layer.open({
                type: 1,
                title: '新增线路',
                content: $('#addRouteModal'),
                area: ['500px', '450px'],
                shade: 0.3
            });
        });
        
        // 取消编辑按钮事件
        $('#cancelEdit').click(function() {
            layer.close(modalIndex);
        });
        
        // 取消新增按钮事件
        $('#cancelAdd').click(function() {
            layer.close(modalIndex);
        });
        
        // 保存修改按钮事件 - 只显示提示，不实际修改数据
        form.on('submit(saveEdit)', function(data) {
            layer.close(modalIndex);
            layer.msg(`线路【${data.field.name}】修改成功`, {icon: 1});
            return false;
        });
        
        // 保存新增按钮事件 - 只显示提示，不实际添加数据
        form.on('submit(saveAdd)', function(data) {
            layer.close(modalIndex);
            layer.msg(`线路【${data.field.name}】添加成功`, {icon: 1});
            return false;
        });
    });
</script>
</body>
</html>